<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <title>Demonising</title>
    
    <!--<script>//For the font.
        (function(d) {
            var config = {
                kitId: 'adc2ijs',
                scriptTimeout: 3000,
                async: true
            },
                h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
        })(document);
    </script><!--end font-->
</head>

<body>    
    
    <div id="container">
         
        <!--txtSec-->
        <section id="txtSec">
            <!--First page-->
            <div id="indexTxtLeft"></div>
            <div id="indexTxtRight"></div>
            <div id="spotlight"></div> 
            <!--Next pages-->
            <div id="txtLeft_1" class="txtLeft"></div>
            <div id="txtRight_2" class="txtRight"></div>
            <div id="txtLeft_3" class="txtLeft"></div>
            <div id="txtRight_4" class="txtRight"></div>
            <div id="txtLeft_5" class="txtLeft"></div>
            <div id="txtRight_6" class="txtRight"></div>
            
            <div id="txtRefer"></div>
        </section><!--end txtSec-->
        
        <!--imgSec-->
        <section id="imgSec"></section>
        
    </div><!--end container-->
    
    <!--scripts-->
    <script src="script/txtAndImgModule.js"></script>
    <!--<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>-->
    <script src="script/jquery.js"></script>
    
    <script>    
    //APP pattern (Object literal)
    var WEBPAGEAPP = {
        
        //variabler
        textIndex: 0,
        textRef: 0,
        imageIndex: 0,
        filstiBilder: "img/",
        lastWord: 0,
        
        //HTML-objekter
        $indexTxtLeft: null,
        $indexTxtRight: null,
        
        $txtLeft_1: null,
        $txtRight_2: null,
        $txtLeft_3: null,
        $txtRight_4: null,
        $txtLeft_5: null,
        $txtRight_6: null,
        
        $txtRefer: null,
        $txtSec: null,
        $imgSec: null,
        
        $spotlight: null,
       // $container: null,
        
        //init-funksjoner
        init: function(){
            
            var WA = WEBPAGEAPP;            
            
            var setElements = function(){
                WA.$indexTxtLeft = $("#indexTxtLeft");
                WA.$indexTxtRight = $("#indexTxtRight");
                
                WA.$txtLeft_1 = $("#txtLeft_1");
                WA.$txtRight_2 = $("#txtRight_2");
                WA.$txtLeft_3 = $("#txtLeft_3");
                WA.$txtRight_4 = $("#txtRight_4");
                WA.$txtLeft_5 = $("#txtLeft_5");
                WA.$txtRight_6 = $("#txtRight_6");
                
                WA.$txtRefer = $("#txtRefer");
                WA.$txtSec = $("#txtSec");
                WA.$imgSec = $("#imgSec");
                
                 WA.$spotlight = $("#spotlight");
               // WA.$container = $("#container");
            }();
            
            var setEvents = function(){
                WA.$txtSec.mouseover(WA.scrollTxt);
                //WA.$imgSec.click(WA.showNextImg);
                //WA.$imgSec.click(WA.showNextPageOfText);
                WA.$txtRefer.click(WA.showNextRef);
                /*WA.$lastWord.click(WA.showNextImg, );*/
                /*WA.$lastWord.click(WA.showTxt);*/
            }();
            
            var setPage = function(){
                //WA.showStartPage();
                //WA.markLastWord();
                //WA.showTxtRef();
                WA.showText();
                WA.showImage();
                //WA.markLastWord();
                //WA.setLinkOnTheLastWord();
                //WA.spotlightFunc();
            }();
            
        }, //--end init
        
        //App-logikk og støttefunksjoner
        showStartPage: function(){
            var WA = WEBPAGEAPP;
            var txtIndex = WEBPAGEAPP.textIndex;
            var texts = TXTANDIMAGEMODUL.getTxt(txtIndex);
            
            var $newText1 = $("<p>" + texts.txt1 + "</p>"); //txt1 henter vi frå lista i JSONList
            var $newText2 = $("<p>" + texts.txt2 + "</p>");
            var $newText3 = $("<p>" + texts.txt3 + "</p>");

            WA.$indexTxtLeft.append($newText1);
            WA.$indexTxtRight.append($newText2).insertAfter($newText1);
                    
            //Last word:
            var lastWord = texts.txt3.split(" ");
        
            for(var i = 0; i < lastWord.length - 1; i++){
                WA.$indexTxtLeft.append(lastWord[i] + " ");
            }
            WA.$indexTxtLeft.append("<a>" + lastWord[lastWord.length - 1] + "</a>")
                .click(WA.showText); 
            //--end Last word
            
        },//--end showStartPage
        
        showTxtRef: function(){
            var refIndex = WEBPAGEAPP.textRef;
            var refs = TXTANDIMAGEMODUL.getTxtRef(refIndex);
            
            var $newRef = $("<p>" + refs + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prevAll("p").remove();
                });
            
            WEBPAGEAPP.$txtRefer.append($newRef);
        },//--end showRefTxt

        showText: function(){
            var WA = WEBPAGEAPP;
            
            var txtIndex = WEBPAGEAPP.textIndex;
            var textsPages = TXTANDIMAGEMODUL.getTxt(txtIndex + 1); //Henter ut heile innhold fra 2. objekt
            
            var $newText1 = $("<p>" + textsPages.txt1 + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prev("p").remove();
                });
            var $newText2 = $("<p>" + textsPages.txt2 + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prev("p").remove();
                });
            var $newText3 = $("<p>" + textsPages.txt3 + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prev("p").remove();
                });
            var $newText4 = $("<p>" + textsPages.txt4 + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prev("p").remove();
                });
            var $newText5 = $("<p>" + textsPages.txt5 + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prev("p").remove();
                });
            var $newText6 = $("<p>" + textsPages.txt6 + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prev("p").remove();
                });
          
            //var howManyTexts = TXTANDIMAGEMODUL.getNumberOfTexts();
            
            //txt1
            if(textsPages.hasOwnProperty("txt1")){
                WA.$txtLeft_1.append($newText1);
            } 
            //txt2
            if(textsPages.hasOwnProperty("txt2")){
                WA.$txtRight_2.append($newText2);
            } 
            //txt3
            if(textsPages.hasOwnProperty("txt3")){
                //WA.$txtLeft_3.append($newText3);
                var lastWord = textsPages.txt3.split(" "); //Split txt to get the last word
                for(var i = 0; i < lastWord.length - 1; i++){
                    WA.$txtLeft_3.append(lastWord[i] + " ");
                }
                WA.$txtLeft_3.append("<a>" + lastWord[lastWord.length - 1] + "</a>");
            } 
            //txt4
            if(textsPages.hasOwnProperty("txt4")){
                WA.$txtRight_4.append($newText4);
            } 
            //txt5 
            if(textsPages.hasOwnProperty("txt5")){
                //WA.$txtLeft_5.append($newText5);
                var lastWord = textsPages.txt5.split(" "); //Split txt to get the last word
                for(var i = 0; i < lastWord.length - 1; i++){
                    WA.$txtLeft_5.append(lastWord[i] + " ");
                }
                WA.$txtLeft_5.append("<a>" + lastWord[lastWord.length - 1] + "</a>");
            } 
            //txt6 
            if(textsPages.hasOwnProperty("txt6")){
                var lastWord = textsPages.txt6.split(" "); //Split txt to get the last word
                for(var i = 0; i < lastWord.length - 1; i++){
                    WA.$txtRight_6.append(lastWord[i] + " ");
                }
                WA.$txtRight_6.append("<a>" + lastWord[lastWord.length - 1] + "</a>")
                    .click(WA.showNextPageOfText);
            }
            
        },//--end showImage
        
        markLastWord: function(){
            //Last word:
            var WA = WEBPAGEAPP;
            
            var txtIndex = WEBPAGEAPP.textIndex;
            var texts = TXTANDIMAGEMODUL.getTxt(txtIndex);
            
            var lastWord = texts.txt6.split(texts);
        
            for(var i = 0; i < lastWord.length - 1; i++){
                WA.$txtRight_6.append(lastWord[i] + " ");
            }
            WA.$txtRight_6.append("<a>" + lastWord[lastWord.length - 1] + "</a>"); 
            //--end Last word
        },
        
        showImage: function(){  
            var index = WEBPAGEAPP.imageIndex;
            var filsti = WEBPAGEAPP.filstiBilder;
            
            var bildeSrc = TXTANDIMAGEMODUL.getImg(index);
            
            var $newImage = $("<img>")
                .attr("src", filsti + bildeSrc)
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prevAll("img").remove();
                });
            
            WEBPAGEAPP.$imgSec.append($newImage);
            
            WEBPAGEAPP.showNextRef();
            
        },//--end showImage
        
        showNextImg: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.imageIndex < ( TXTANDIMAGEMODUL.getNumberOfImages() - 1 ) ){
                WA.imageIndex++;
            }else{
                WA.imageIndex = 0;
            } 
            WA.showImage();
        }, //--end showNextImage 
        
        showNextPageOfText: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.textIndex < ( TXTANDIMAGEMODUL.getNumberOfTexts() - 1 )){
                WA.textIndex++;
            }else{
                WA.textIndex = 0;
            } 
            WA.showText();
        }, //--end showNextRef   
        
        showNextRef: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.textRef < ( TXTANDIMAGEMODUL.getNumberOfTexts() - 1 )){
                WA.textRef++;
            }else{
                WA.textRef = 0;
            } 
            WA.showTxtRef();
        }, //--end showNextRef        
        
        scrollTxt: function(){ //Har funnit problemet.. jobber på sakne
            var distancePerSec = 50;
            
            //var h = WEBPAGEAPP.$txtSec.height();
            var h = $("html, body").height();
            var targetScrollTop = h + $(window).height();
            var distanceToTravel = targetScrollTop - $(window).scrollTop();
            var animationDuration = (distanceToTravel / distancePerSec) * 1000;
                
            $("html, body").animate({
            //$(WEBPAGEAPP.$txtSec).animate({
                //scrollTop: 0
                scrollTop: targetScrollTop
            }, animationDuration, 'linear');
        }, //--end scrollTxt
        
        spotlightFunc: (function() {
            var WA = WEBPAGEAPP;
            
            
            WA.$spotlight.animate({
                height: "150px",
                width: "150px",
                "left": "-1577px",
                "top": "-1930px",
                },
                15000,
                'linear',
                function(){

                        var $mouseX = 700, $mouseY = 350;
                        var $xp = 700, $yp = 350;

                        $(document).mousemove(function(e){
                        $mouseX = e.pageX;
                        $mouseY = e.pageY;

                        });

                      var $loop = setInterval(function(){
                        $xp += (($mouseX - $xp)/2);
                        $yp += (($mouseY - $yp)/2);
                        WA.$spotlight.css({left:($xp -2380)+'px',top:($yp -2380) +'px'});
                        }, 10);

                        }),
                
          WA.$spotlight.css({
            width: "2000px",
            height: "2000px",
            left: "-2600px",
            top: "-2700px",
            borderRadius: "50%",
            margin: "10px",
            border: "2200px solid black",
            position: "absolute",
            boxShadow: "inset 10px 10px 49px 57px rgba(0,0,0,0.65)",
            });
    
        }) //--end spotlightFunc
        // End spotlight
        
    }; //--end WEBPAGEWAPP
    
    //document.ready trigger vår WEBPAGEAPP når DOM er klart
    $(function(){
        WEBPAGEAPP.init();        
    });   
        
    </script>
    
</body>
    
</html>
