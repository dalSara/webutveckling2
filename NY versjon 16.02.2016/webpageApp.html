<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <title>Demonising</title>
    
    <!--<script>//For the font.
        (function(d) {
            var config = {
                kitId: 'adc2ijs',
                scriptTimeout: 3000,
                async: true
            },
                h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
        })(document);
    </script><!--end font-->
</head>

<body>    
    
    <div id="container">
         
        <!--txtSec-->
        <section id="txtSec">
            <!--First page-->
            <div id="indexTxtLeft"></div>
            <div id="indexTxtRight"></div>
            <div id="spotlight"></div> 
            <!--Next pages-->
            <div id="txtLeft_1" class="txtLeft"></div>
            <div id="txtRight_2" class="txtRight"></div>
            <div id="txtLeft_3" class="txtLeft"></div>
            <div id="txtRight_4" class="txtRight"></div>
            <div id="txtLeft_5" class="txtLeft"></div>
            <div id="txtRight_6" class="txtRight"></div>
            
            <div id="txtRefer"></div>
        </section><!--end txtSec-->
        
        <!--imgSec-->
        <section id="imgSec"></section>
        
    </div><!--end container-->
    
    <!--scripts-->
    <script src="script/txtAndImgModule.js"></script>
    <!--<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>-->
    <script src="script/jquery.js"></script>
    
    <script>    
    //APP pattern (Object literal)
    var WEBPAGEAPP = {
        
        //variabler
        textIndex: 0,
        textRef: 0,
        imageIndex: 0,
        filstiBilder: "img/",
        lastWord: 0,
        
        //HTML-objekter
        $indexTxtLeft: null,
        $indexTxtRight: null,
        
        $txtLeft_1: null,
        $txtRight_2: null,
        $txtLeft_3: null,
        $txtRight_4: null,
        $txtLeft_5: null,
        $txtRight_6: null,
        
        $txtRefer: null,
        $txtSec: null,
        $imgSec: null,
        
        $spotlight: null,
       // $container: null,
        
        //init-funksjoner
        init: function(){
            
            var WA = WEBPAGEAPP;            
            
            var setElements = function(){
                WA.$indexTxtLeft = $("#indexTxtLeft");
                WA.$indexTxtRight = $("#indexTxtRight");
                
                WA.$txtLeft_1 = $("#txtLeft_1");
                WA.$txtRight_2 = $("#txtRight_2");
                WA.$txtLeft_3 = $("#txtLeft_3");
                WA.$txtRight_4 = $("#txtRight_4");
                WA.$txtLeft_5 = $("#txtLeft_5");
                WA.$txtRight_6 = $("#txtRight_6");
                
                WA.$txtRefer = $("#txtRefer");
                WA.$txtSec = $("#txtSec");
                WA.$imgSec = $("#imgSec");
                
                WA.$spotlight = $("#spotlight");
               // WA.$container = $("#container");
            }();
            
             var setEvents = function(){
                //WA.$txtSec.mouseenter(WA.scrollTxt);
            }();
            
            var setPage = function(){
                //WA.showStartPage();
                WA.showText();
                WA.showImage();
                //WA.spotlightFunc();
            }();
            
        }, //--end init
        
        //App-logikk og støttefunksjoner
        showStartPage: function(){
            var WA = WEBPAGEAPP;
            var txtIndex = WEBPAGEAPP.textIndex;
            var texts = TXTANDIMAGEMODUL.getTxt(txtIndex);
            
            var $newText1 = $("<p>" + texts.txt1 + "</p>"); //txt1 henter vi frå lista i JSONList
            var $newText2 = $("<p>" + texts.txt2 + "</p>");
            var $newText3 = $("<p>" + texts.txt3 + "</p>");

            WA.$indexTxtLeft.append($newText1);
            WA.$indexTxtRight.append($newText2).insertAfter($newText1);
                    
            //Last word:
            var lastWord = texts.txt3.split(" ");
        
            for(var i = 0; i < lastWord.length - 1; i++){
                WA.$indexTxtLeft.append(lastWord[i] + " ");
            }
            WA.$indexTxtLeft.append("<a>" + lastWord[lastWord.length - 1] + "</a>")
                .click(WA.showText); 
            //--end Last word
            WA.showTxtRef();
            
        },//--end showStartPage
        
        showTxtRef: function(){
            var refIndex = WEBPAGEAPP.textRef;
            var refs = TXTANDIMAGEMODUL.getTxtRef(refIndex);
            
            var $newRef = $("<p>" + refs + "</p>")
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prevAll("p").remove();
                });
            
            WEBPAGEAPP.$txtRefer.append($newRef);
        },//--end showRefTxt

        showText: function(){
            var WA = WEBPAGEAPP;
            
            var txtIndex = WEBPAGEAPP.textIndex;
            var textsPages = TXTANDIMAGEMODUL.getTxt(txtIndex + 1); //Henter ut heile innhold fra 2. objekt
            
            var $newText1 = $("<p>" + textsPages.txt1 + "</p>");
            var $newText2 = $("<p>" + textsPages.txt2 + "</p>");
            var $newText3 = $("<p>" + textsPages.txt3 + "</p>");
            var $newText4 = $("<p>" + textsPages.txt4 + "</p>");
            var $newText5 = $("<p>" + textsPages.txt5 + "</p>");
            var $newText6 = $("<p>" + textsPages.txt6 + "</p>");
            
            $(document).load().scrollTop(0); //Get text to top when loading new page
            
            var last = "" 
            
            if(textsPages.hasOwnProperty("txt1")){
                WA.$txtLeft_1.append($newText1);
                last = WA.$txtLeft_1
            } 
            if(textsPages.hasOwnProperty("txt2")){
                WA.$txtRight_2.append($newText2);
                last = WA.$txtRight_2
            } 
            if(textsPages.hasOwnProperty("txt3")){
                WA.$txtLeft_3.append($newText3);
                last = WA.$txtLeft_3
            } 
            if(textsPages.hasOwnProperty("txt4")){
                WA.$txtRight_4.append($newText4);
                last = WA.$txtRight_4                
            } 
            if(textsPages.hasOwnProperty("txt5")){
                WA.$txtLeft_5.append($newText5);
                last = WA.$txtLeft_5
            } 
            if(textsPages.hasOwnProperty("txt6")){
                WA.$txtRight_6.append($newText6);
                last = WA.$txtRight_6
            } 

            var lastWord = last.children(":first").html().trim().split(" "); //Split txt to get the last word
            last.children("*").replaceWith("")  
            
            last.append("<p>")
            paragraph = last.children(":first")
            
            for(var i = 0; i < lastWord.length - 1; i++){
                    paragraph.append(lastWord[i] + " ");
            }
            paragraph.append("<a>" + lastWord[lastWord.length - 1] + "</a>")
                .on("click", function(){
                $(this).remove().stop();
                
                $newText1.remove().prevAll("p");
                $newText2.remove().prevAll("p");
                $newText3.remove().prevAll("p");
                $newText4.remove().prevAll("p");
                $newText5.remove().prevAll("p");
                $newText6.remove().prevAll("p");
                
                WA.showNextPageOfText();
                WA.showNextImg();
            });
            
            WA.showNextRef();                         
            
        },//--end showImage
        
        showImage: function(){  
            var WA = WEBPAGEAPP;
            
            var index = WA.imageIndex;
            var filsti = WA.filstiBilder;
            
            var bildeSrc = TXTANDIMAGEMODUL.getImg(index);
            
            var $newImage = $("<img>")
                .attr("src", filsti + bildeSrc)
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prevAll("img").remove();
                });
            
            WA.$imgSec.append($newImage);
            
            WA.showNextRef();
            
        },//--end showImage
        
        showNextImg: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.imageIndex < ( TXTANDIMAGEMODUL.getNumberOfImages() - 1 ) ){
                WA.imageIndex++;
            }else{
                WA.imageIndex = 0;
            } 
            WA.showImage();
        }, //--end showNextImage 
        
        showNextPageOfText: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.textIndex < ( TXTANDIMAGEMODUL.getNumberOfTexts() - 1 )){
                WA.textIndex++;
            }else{
                WA.textIndex = 0;
            } 
            WA.showText();
        }, //--end showNextRef   
        
        showNextRef: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.textRef < ( TXTANDIMAGEMODUL.getNumberOfTexts() - 1 )){
                WA.textRef++;
            }else{
                WA.textRef = 0;
            } 
            WA.showTxtRef();  
        },//--end showImage
        
        showImage: function(){  
            var WA = WEBPAGEAPP;
            
            var index = WA.imageIndex;
            var filsti = WA.filstiBilder;
            
            var bildeSrc = TXTANDIMAGEMODUL.getImg(index);
            
            var $newImage = $("<img>")
                .attr("src", filsti + bildeSrc)
                .animate({"left": "0px", "opacity": "1"}, 1, function(){
                    $(this).prevAll("img").remove();
                });
            
            WA.$imgSec.append($newImage);
            
            WA.showNextRef();
            
        },//--end showImage
        
        showNextImg: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.imageIndex < ( TXTANDIMAGEMODUL.getNumberOfImages() - 1 ) ){
                WA.imageIndex++;
            }else{
                WA.imageIndex = 0;
            } 
            WA.showImage();
        }, //--end showNextImage 
        
        showNextPageOfText: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.textIndex < ( TXTANDIMAGEMODUL.getNumberOfTexts() - 1 )){
                WA.textIndex++;
            }else{
                WA.textIndex = 0;
            } 
            WA.showText();
        }, //--end showNextRef   
        
        showNextRef: function(){
            var WA = WEBPAGEAPP;
            
            if(WA.textRef < ( TXTANDIMAGEMODUL.getNumberOfTexts() - 1 )){
                WA.textRef++;
            }else{
                WA.textRef = 0;
            } 
            WA.showTxtRef();
        }, //--end showNextRef        
        
        /*scrollTxt: function(){
            var WA = WEBPAGEAPP;
                
            WA.$txtSec
                .animate({
                "top": "-500px"}, 15000, 'linear');
        }, //--end scrollTxt

        /*spotlightFunc: (function() {
            var WA = WEBPAGEAPP;

            WA.$spotlight.animate({
                "height": "150px",
                "width": "150px",
                "left": "-4648px",
                "top": "-4935px",
            },
                15000,
                'linear',
                function(){
                
                    var $mouseX = 625, $mouseY = 315;
                    var $xp = 625, $yp = 315;

                    $(document).mousemove(function(e){
                    $mouseX = e.pageX;
                    $mouseY = e.pageY;
                    });

                var $followMouse = setInterval(function(){
                    $xp += (($mouseX - $xp)/2);
                    $yp += (($mouseY - $yp)/2);
                    WA.$spotlight.css({left:($xp -4860)+'px',top:($yp -4860) +'px'});
                }, 10);
            });
        })*/ //--end spotlightFunc
    }; //--end WEBPAGEWAPP
    
    //document.ready trigger vår WEBPAGEAPP når DOM er klart
    $(function(){
        WEBPAGEAPP.init();        
    });   
        
    </script>
    
</body>  
</html>